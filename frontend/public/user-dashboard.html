<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TipStorm User Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h2>TipStorm Dashboard</h2>

<label>Email</label>
<input type="email" id="email">

<label>Plan</label>
<select id="plan">
  <option value="free">Free</option>
  <option value="weekly">Weekly</option>
  <option value="monthly">Monthly</option>
  <option value="vip">VIP</option>
</select>

<button onclick="loadSlips()">Load Slips</button>
<button onclick="filterDate()">Filter by Date</button>

<input type="date" id="filterDate">

<div id="slipGrid" class="grid"></div>

<script>
const API = "https://tipstorm-web-app-1.onrender.com";

// LOAD SLIPS (send plan)
async function loadSlips() {
  const plan = document.getElementById("plan").value;
  const res = await fetch(`${API}/slips?plan=${plan}`);
  const data = await res.json();

  const grid = document.getElementById("slipGrid");
  grid.innerHTML = "";

  data.slips.forEach(slip => {
    const card = document.createElement("div");
    card.className = "card";

    const badge = slip.access === "free"
      ? `<span class="badge free">FREE</span>`
      : `<span class="badge vip">PREMIUM</span>`;

    card.innerHTML = `
      <strong>${slip.date}</strong> ${badge}<br>
      Total Odds: ${slip.totalOdds.toFixed(2)}<br>
      <hr>
    `;

    slip.games.forEach(g => {
      card.innerHTML += `
        <div>
          <strong>${g.home} vs ${g.away}</strong><br>
          Odd: ${g.odd}<br>
          Over/Under: ${g.overUnder || "N/A"}<br>
          <span class="badge ${g.result}">
            ${g.result.toUpperCase()}
          </span>
        </div>
        <hr>
      `;
    });

    grid.appendChild(card);
  });
}

// FILTER BY DATE (send plan)
async function filterDate() {
  const date = document.getElementById("filterDate").value;
  const plan = document.getElementById("plan").value;

  const res = await fetch(`${API}/slips?plan=${plan}&date=${date}`);
  const data = await res.json();

  const grid = document.getElementById("slipGrid");
  grid.innerHTML = "";

  data.slips.forEach(slip => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <strong>${slip.date}</strong><br>
      Total Odds: ${slip.totalOdds.toFixed(2)}<br>
    `;
    grid.appendChild(card);
  });
}

loadSlips();
</script>

</body>
</html> 
